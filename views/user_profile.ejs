<%- include("partials/header.ejs") %>
<div class="base-container">
    <div class="container">
        <div class="row align-items-center flex-row-reverse">
            <div class="col-lg-6">
                <div class="about-text go-to">
                    <h1>Profile of <%= first_name %> <%= last_name %></h1>
                    <div class="row about-list">
                        <div class="col-md-6">
                            <!-- This displays the user's information -->
                            <div class="media">
                                <label>Email</label>
                                <p><b><%= email %></b></p>
                            </div>
                            <div class="media">
                                <label>Membership Start Date</label>
                                <p><b><%= date_joined ? new Date(date_joined).toLocaleString('en-GB', { 
                                    day: '2-digit',
                                    month: '2-digit', 
                                    year: 'numeric'
                                }) : 'N/A' %></b></p>
                            </div>
                            <div class="media">
                                <label>Books in Use</label>
                                <p><b><%= booksInUse %></b></p>
                            </div>
                            <div class="media">
                                <label>Overdue Books</label>
                                <p><b><%= overdueBooks %></b></p>
                            </div>
                            <div class="media">
                                <label>Total Fine Amount</label>
                                <p><b>R <%= totalFine %></b></p>
                            </div>
                            <div class="media">
                                <label>Total Books Returned</label>
                                <p><b><%= totalBooksBorrowed %></b></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="about-avatar">
                    <img class="account-profile-image" src="/images/Profile_Account.png" alt="Profile Picture">
                </div>
            </div>
        </div>
        <div class="counter">
            <div class="row">
                <div class="account-button-container">
                    <div class="count-data text-center">
                        <form method="POST" action="/delete_account/<%= email %>" onsubmit="return confirm('Are you sure you want to delete this account?');">
                            <button type="submit" class="account-info-buttons">Delete Account</button>
                        </form>
                    </div>
                </div>
                <div class="account-button-container">
                    <div class="count-data text-center">
                        <!-- This will take the user to the page where they can view borrowed books -->
                        <form method="GET" action="/returned_books">
                            <input type="hidden" name="request_id" value="<%= requestIds %>">
                            <input type="hidden" name="user_email" value="<%= email %>">
                            <button type="submit" class="account-info-buttons">Return Books</button>
                        </form>
                    </div>
                </div>
                <div class="account-button-container">
                    <div class="count-data text-center">
                        <button class="account-info-buttons" onclick="window.history.back()" type="button">Go back</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include("partials/footer.ejs") %>
